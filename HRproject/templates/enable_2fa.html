<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Enable Two-Factor Authentication</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/enable_2fa.css') }}">
</head>
<body>
  <div class="container">
    <h1>Enable Two-Factor Authentication</h1>
    <p>Scan the QR code below with your authentication app.<br>
       Then enter the 6-digit code to complete setup.</p>

    <div class="qr-wrapper">
      {% if qr_data %}
        <img src="data:image/png;base64,{{ qr_data }}" alt="QR Code">
      {% else %}
        <p class="uri-text">Scan this URI instead:</p>
        <code class="uri-box">{{ uri }}</code>
      {% endif %}
    </div>

    <form method="POST" action="{{ url_for('verify_2fa') }}">
      <label for="token">Authentication Code<span style="color:red">*</span></label>
      <input
        type="text"
        id="token"
        name="token"
        placeholder="Enter 6-digit code"
        maxlength="6"
        pattern="\d{6}"
        required
      />

      <button type="submit">Verify</button>
    </form>

{#    {% with messages = get_flashed_messages() %}#}
{#      {% if messages %}#}
{#        {% for msg in messages %}#}
{#          <div class="flash">{{ msg }}</div>#}
{#        {% endfor %}#}
{#      {% endif %}#}
{#    {% endwith %}#}
  </div>
</body>
</html>
