<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Two-Factor Authentication</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/two_factor.css') }}">
</head>
<body>
<div class="container">
    <h1>Two-Factor Authentication</h1>
    <p>Please enter the 6-digit code from your authenticator app.</p>

    <form method="POST" action="{{ url_for('two_factor') }}">
        {{ form.hidden_tag() if form else '' }}

        <label for="totp">Authentication Code<span style="color:red">*</span></label>
        <input
            type="text"
            id="totp"
            name="totp"
            placeholder="Enter 6-digit code"
            maxlength="6"
            pattern="\d{6}"
            required
        >

        <button type="submit">Verify</button>


        <p class="recovery-text">
            Lost access? <a href="{{ url_for('enable_2fa', reset=1) }}">Setup 2FA again</a>
        </p>
    </form>

{#    {% with messages = get_flashed_messages() %}#}
{#      {% if messages %}#}
{#        {% for msg in messages %}#}
{#          <div class="flash">{{ msg }}</div>#}
{#        {% endfor %}#}
{#      {% endif %}#}
{#    {% endwith %}#}
</div>
</body>
</html>
